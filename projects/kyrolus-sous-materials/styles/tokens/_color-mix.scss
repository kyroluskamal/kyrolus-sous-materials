// ============================================================================
// COLOR-MIX UTILITIES
// CSS color-mix() function for mixing colors in any color space
// Browser Support: Chrome 111+, Firefox 113+, Safari 16.2+
// ============================================================================

// ----------------------------------------------------------------------------
// CSS VARIABLES FOR COLOR MIXING
// ----------------------------------------------------------------------------

:root {
  // Base colors for mixing
  --mix-color-1: var(--primary, #3b82f6);
  --mix-color-2: var(--secondary, #8b5cf6);
  --mix-color-space: srgb;

  // Pre-mixed color palette
  --color-mix-10: color-mix(
    in srgb,
    var(--mix-color-1) 10%,
    var(--mix-color-2)
  );
  --color-mix-20: color-mix(
    in srgb,
    var(--mix-color-1) 20%,
    var(--mix-color-2)
  );
  --color-mix-30: color-mix(
    in srgb,
    var(--mix-color-1) 30%,
    var(--mix-color-2)
  );
  --color-mix-40: color-mix(
    in srgb,
    var(--mix-color-1) 40%,
    var(--mix-color-2)
  );
  --color-mix-50: color-mix(
    in srgb,
    var(--mix-color-1) 50%,
    var(--mix-color-2)
  );
  --color-mix-60: color-mix(
    in srgb,
    var(--mix-color-1) 60%,
    var(--mix-color-2)
  );
  --color-mix-70: color-mix(
    in srgb,
    var(--mix-color-1) 70%,
    var(--mix-color-2)
  );
  --color-mix-80: color-mix(
    in srgb,
    var(--mix-color-1) 80%,
    var(--mix-color-2)
  );
  --color-mix-90: color-mix(
    in srgb,
    var(--mix-color-1) 90%,
    var(--mix-color-2)
  );
}

// ----------------------------------------------------------------------------
// TINT UTILITIES (Mix with white)
// ----------------------------------------------------------------------------

// Generate tints of primary color
.tint-primary-10 {
  --tinted-color: color-mix(in srgb, var(--primary, #3b82f6) 90%, white);
}

.tint-primary-20 {
  --tinted-color: color-mix(in srgb, var(--primary, #3b82f6) 80%, white);
}

.tint-primary-30 {
  --tinted-color: color-mix(in srgb, var(--primary, #3b82f6) 70%, white);
}

.tint-primary-40 {
  --tinted-color: color-mix(in srgb, var(--primary, #3b82f6) 60%, white);
}

.tint-primary-50 {
  --tinted-color: color-mix(in srgb, var(--primary, #3b82f6) 50%, white);
}

// Background tints
.bg-tint-10 {
  background-color: color-mix(in srgb, var(--primary, #3b82f6) 90%, white);
}

.bg-tint-20 {
  background-color: color-mix(in srgb, var(--primary, #3b82f6) 80%, white);
}

.bg-tint-30 {
  background-color: color-mix(in srgb, var(--primary, #3b82f6) 70%, white);
}

.bg-tint-40 {
  background-color: color-mix(in srgb, var(--primary, #3b82f6) 60%, white);
}

.bg-tint-50 {
  background-color: color-mix(in srgb, var(--primary, #3b82f6) 50%, white);
}

// ----------------------------------------------------------------------------
// SHADE UTILITIES (Mix with black)
// ----------------------------------------------------------------------------

.shade-primary-10 {
  --shaded-color: color-mix(in srgb, var(--primary, #3b82f6) 90%, black);
}

.shade-primary-20 {
  --shaded-color: color-mix(in srgb, var(--primary, #3b82f6) 80%, black);
}

.shade-primary-30 {
  --shaded-color: color-mix(in srgb, var(--primary, #3b82f6) 70%, black);
}

.shade-primary-40 {
  --shaded-color: color-mix(in srgb, var(--primary, #3b82f6) 60%, black);
}

.shade-primary-50 {
  --shaded-color: color-mix(in srgb, var(--primary, #3b82f6) 50%, black);
}

// Background shades
.bg-shade-10 {
  background-color: color-mix(in srgb, var(--primary, #3b82f6) 90%, black);
}

.bg-shade-20 {
  background-color: color-mix(in srgb, var(--primary, #3b82f6) 80%, black);
}

.bg-shade-30 {
  background-color: color-mix(in srgb, var(--primary, #3b82f6) 70%, black);
}

.bg-shade-40 {
  background-color: color-mix(in srgb, var(--primary, #3b82f6) 60%, black);
}

.bg-shade-50 {
  background-color: color-mix(in srgb, var(--primary, #3b82f6) 50%, black);
}

// ----------------------------------------------------------------------------
// ALPHA/TRANSPARENCY UTILITIES
// ----------------------------------------------------------------------------

.bg-alpha-10 {
  background-color: color-mix(
    in srgb,
    var(--primary, #3b82f6) 10%,
    transparent
  );
}

.bg-alpha-20 {
  background-color: color-mix(
    in srgb,
    var(--primary, #3b82f6) 20%,
    transparent
  );
}

.bg-alpha-30 {
  background-color: color-mix(
    in srgb,
    var(--primary, #3b82f6) 30%,
    transparent
  );
}

.bg-alpha-40 {
  background-color: color-mix(
    in srgb,
    var(--primary, #3b82f6) 40%,
    transparent
  );
}

.bg-alpha-50 {
  background-color: color-mix(
    in srgb,
    var(--primary, #3b82f6) 50%,
    transparent
  );
}

.bg-alpha-60 {
  background-color: color-mix(
    in srgb,
    var(--primary, #3b82f6) 60%,
    transparent
  );
}

.bg-alpha-70 {
  background-color: color-mix(
    in srgb,
    var(--primary, #3b82f6) 70%,
    transparent
  );
}

.bg-alpha-80 {
  background-color: color-mix(
    in srgb,
    var(--primary, #3b82f6) 80%,
    transparent
  );
}

.bg-alpha-90 {
  background-color: color-mix(
    in srgb,
    var(--primary, #3b82f6) 90%,
    transparent
  );
}

// ----------------------------------------------------------------------------
// COLOR SPACE MIXING
// ----------------------------------------------------------------------------

// SRGB color space (standard)
.mix-srgb {
  --mix-color-space: srgb;
}

// SRGB Linear (better for gradients)
.mix-srgb-linear {
  --mix-color-space: srgb-linear;
}

// OKLCH (perceptually uniform - best for most uses)
.mix-oklch {
  --mix-color-space: oklch;
}

// OKLAB (perceptually uniform)
.mix-oklab {
  --mix-color-space: oklab;
}

// LAB color space
.mix-lab {
  --mix-color-space: lab;
}

// LCH color space
.mix-lch {
  --mix-color-space: lch;
}

// HSL color space
.mix-hsl {
  --mix-color-space: hsl;
}

// HWB color space
.mix-hwb {
  --mix-color-space: hwb;
}

// ----------------------------------------------------------------------------
// TWO-COLOR MIXING UTILITIES
// ----------------------------------------------------------------------------

// Mix two custom colors
.mix-colors {
  --mixed-result: color-mix(
    in var(--mix-color-space, srgb),
    var(--mix-color-1) var(--mix-amount, 50%),
    var(--mix-color-2)
  );
}

// Preset mixtures
.mix-50 {
  --mix-amount: 50%;
}

.mix-25 {
  --mix-amount: 25%;
}

.mix-75 {
  --mix-amount: 75%;
}

// Background with mixed colors
.bg-mixed {
  background-color: color-mix(
    in var(--mix-color-space, srgb),
    var(--mix-color-1, var(--primary)) var(--mix-amount, 50%),
    var(--mix-color-2, var(--secondary))
  );
}

// Text with mixed colors
.text-mixed {
  color: color-mix(
    in var(--mix-color-space, srgb),
    var(--mix-color-1, var(--primary)) var(--mix-amount, 50%),
    var(--mix-color-2, var(--secondary))
  );
}

// Border with mixed colors
.border-mixed {
  border-color: color-mix(
    in var(--mix-color-space, srgb),
    var(--mix-color-1, var(--primary)) var(--mix-amount, 50%),
    var(--mix-color-2, var(--secondary))
  );
}

// ----------------------------------------------------------------------------
// SEMANTIC COLOR MIXING
// ----------------------------------------------------------------------------

// Primary variations
.bg-primary-light {
  background-color: color-mix(in oklch, var(--primary, #3b82f6) 70%, white);
}

.bg-primary-lighter {
  background-color: color-mix(in oklch, var(--primary, #3b82f6) 40%, white);
}

.bg-primary-dark {
  background-color: color-mix(in oklch, var(--primary, #3b82f6) 70%, black);
}

.bg-primary-darker {
  background-color: color-mix(in oklch, var(--primary, #3b82f6) 40%, black);
}

// Secondary variations
.bg-secondary-light {
  background-color: color-mix(in oklch, var(--secondary, #8b5cf6) 70%, white);
}

.bg-secondary-lighter {
  background-color: color-mix(in oklch, var(--secondary, #8b5cf6) 40%, white);
}

.bg-secondary-dark {
  background-color: color-mix(in oklch, var(--secondary, #8b5cf6) 70%, black);
}

.bg-secondary-darker {
  background-color: color-mix(in oklch, var(--secondary, #8b5cf6) 40%, black);
}

// Success variations
.bg-success-light {
  background-color: color-mix(in oklch, var(--success, #10b981) 70%, white);
}

.bg-success-dark {
  background-color: color-mix(in oklch, var(--success, #10b981) 70%, black);
}

// Warning variations
.bg-warning-light {
  background-color: color-mix(in oklch, var(--warning, #f59e0b) 70%, white);
}

.bg-warning-dark {
  background-color: color-mix(in oklch, var(--warning, #f59e0b) 70%, black);
}

// Error variations
.bg-error-light {
  background-color: color-mix(in oklch, var(--error, #ef4444) 70%, white);
}

.bg-error-dark {
  background-color: color-mix(in oklch, var(--error, #ef4444) 70%, black);
}

// ----------------------------------------------------------------------------
// GRADIENT UTILITIES WITH COLOR-MIX
// ----------------------------------------------------------------------------

.gradient-mixed {
  background: linear-gradient(
    to right,
    var(--mix-color-1, var(--primary)),
    color-mix(in oklch, var(--mix-color-1) 50%, var(--mix-color-2)),
    var(--mix-color-2, var(--secondary))
  );
}

.gradient-tint {
  background: linear-gradient(
    to bottom,
    color-mix(in oklch, var(--primary, #3b82f6) 30%, white),
    var(--primary, #3b82f6),
    color-mix(in oklch, var(--primary, #3b82f6) 30%, black)
  );
}

// ----------------------------------------------------------------------------
// HOVER STATE MIXING
// ----------------------------------------------------------------------------

.hover-darken {
  transition: background-color 0.2s ease;

  &:hover {
    background-color: color-mix(in srgb, currentColor 90%, black);
  }
}

.hover-lighten {
  transition: background-color 0.2s ease;

  &:hover {
    background-color: color-mix(in srgb, currentColor 90%, white);
  }
}

// Interactive button with color-mix
.btn-mixed {
  background-color: var(--btn-color, var(--primary));
  transition: background-color 0.2s ease;

  &:hover {
    background-color: color-mix(
      in oklch,
      var(--btn-color, var(--primary)) 85%,
      black
    );
  }

  &:active {
    background-color: color-mix(
      in oklch,
      var(--btn-color, var(--primary)) 70%,
      black
    );
  }
}

// ----------------------------------------------------------------------------
// DARK MODE SUPPORT
// ----------------------------------------------------------------------------

[data-theme="dark"],
.dark {
  // Invert tint/shade for dark mode
  .bg-tint-10 {
    background-color: color-mix(in srgb, var(--primary, #3b82f6) 90%, black);
  }

  .bg-tint-20 {
    background-color: color-mix(in srgb, var(--primary, #3b82f6) 80%, black);
  }

  .bg-tint-30 {
    background-color: color-mix(in srgb, var(--primary, #3b82f6) 70%, black);
  }

  .bg-shade-10 {
    background-color: color-mix(in srgb, var(--primary, #3b82f6) 90%, white);
  }

  .bg-shade-20 {
    background-color: color-mix(in srgb, var(--primary, #3b82f6) 80%, white);
  }

  .bg-shade-30 {
    background-color: color-mix(in srgb, var(--primary, #3b82f6) 70%, white);
  }
}

// ----------------------------------------------------------------------------
// COMPONENT EXAMPLES
// ----------------------------------------------------------------------------

// Card with subtle background
.card-subtle {
  background-color: color-mix(in oklch, var(--primary, #3b82f6) 10%, white);
  border: 1px solid color-mix(in oklch, var(--primary, #3b82f6) 30%, white);
}

// Alert variations
.alert-info-subtle {
  background-color: color-mix(in oklch, var(--info, #3b82f6) 15%, white);
  border-left: 4px solid var(--info, #3b82f6);
  color: color-mix(in oklch, var(--info, #3b82f6) 50%, black);
}

.alert-success-subtle {
  background-color: color-mix(in oklch, var(--success, #10b981) 15%, white);
  border-left: 4px solid var(--success, #10b981);
  color: color-mix(in oklch, var(--success, #10b981) 50%, black);
}

.alert-warning-subtle {
  background-color: color-mix(in oklch, var(--warning, #f59e0b) 15%, white);
  border-left: 4px solid var(--warning, #f59e0b);
  color: color-mix(in oklch, var(--warning, #f59e0b) 60%, black);
}

.alert-error-subtle {
  background-color: color-mix(in oklch, var(--error, #ef4444) 15%, white);
  border-left: 4px solid var(--error, #ef4444);
  color: color-mix(in oklch, var(--error, #ef4444) 50%, black);
}

// Badge with muted colors
.badge-muted {
  background-color: color-mix(
    in oklch,
    var(--badge-color, var(--primary)) 20%,
    white
  );
  color: color-mix(in oklch, var(--badge-color, var(--primary)) 60%, black);
  padding: 0.25em 0.5em;
  border-radius: 0.25em;
  font-size: 0.875em;
}

// ----------------------------------------------------------------------------
// UTILITY CLASSES FOR CUSTOM MIXING
// ----------------------------------------------------------------------------

// Set color 1
.mix-from-primary {
  --mix-color-1: var(--primary, #3b82f6);
}
.mix-from-secondary {
  --mix-color-1: var(--secondary, #8b5cf6);
}
.mix-from-accent {
  --mix-color-1: var(--accent, #f59e0b);
}
.mix-from-success {
  --mix-color-1: var(--success, #10b981);
}
.mix-from-warning {
  --mix-color-1: var(--warning, #f59e0b);
}
.mix-from-error {
  --mix-color-1: var(--error, #ef4444);
}

// Set color 2
.mix-to-primary {
  --mix-color-2: var(--primary, #3b82f6);
}
.mix-to-secondary {
  --mix-color-2: var(--secondary, #8b5cf6);
}
.mix-to-accent {
  --mix-color-2: var(--accent, #f59e0b);
}
.mix-to-success {
  --mix-color-2: var(--success, #10b981);
}
.mix-to-warning {
  --mix-color-2: var(--warning, #f59e0b);
}
.mix-to-error {
  --mix-color-2: var(--error, #ef4444);
}
.mix-to-white {
  --mix-color-2: white;
}
.mix-to-black {
  --mix-color-2: black;
}
.mix-to-transparent {
  --mix-color-2: transparent;
}

// ----------------------------------------------------------------------------
// FEATURE DETECTION
// ----------------------------------------------------------------------------

@supports (background: color-mix(in srgb, red 50%, blue)) {
  .color-mix-supported {
    --color-mix-supported: 1;
  }
}
