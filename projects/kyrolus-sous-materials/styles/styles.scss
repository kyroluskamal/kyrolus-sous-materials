// =============================================================================
// KYROLUS SOUS MATERIALS - UNIFIED SCSS FRAMEWORK
// =============================================================================
// The most powerful SCSS framework for Angular applications.
// Single entry point - everything you need in one place.
//
// FEATURES:
// ---------
// - CSS Layers for cascade control
// - Dark mode support (data-theme="dark")
// - RTL/LTR support (dir="rtl")
// - 22 color palettes with 50-950 shades
// - Fluid typography with clamp()
// - Modern animations & effects
// - Glassmorphism, gradients, shadows
// - Container queries
// - WCAG 2.1 accessibility utilities
// - State variants (hover, focus, active, disabled)
// - Group/peer utilities for complex interactions
// - Dark mode utility variants
// - Advanced CSS features (@property, scroll animations, view transitions)
// - Angular CDK integration
// - Component theming mixins
// - All original components preserved
//
// CUTTING-EDGE FEATURES (Industry First!):
// ----------------------------------------
// - CSS Anchor Positioning (position relative to any element)
// - :has() Parent Selector Utilities
// - @starting-style Entry Animations (CSS-only appear animations)
// - Native light-dark() Function
// - Container Style Queries (query by CSS values, not just size)
// - text-wrap: balance/pretty (modern typography)
// - field-sizing: content (auto-sizing inputs)
// - CSS Masonry Grid
// - Relative Color Syntax (color-mix, oklch)
// - View Transitions API (page transition effects)
// - Scroll-driven Animations (no JS scroll animations)
// - Container Query Units (cqi, cqw, cqh)
// - Full Logical Properties (RTL/LTR ready)
// - CSS Subgrid (child grid alignment)
// - Native Popover API styling
// - Modern Viewport Units (dvh, svh, lvh)
// - Motion Path animations
// - CSS Masks and masking
// - @property typed custom properties
// - Advanced text decoration
// - OKLCH perceptual color system
// - Native Dialog element styling
// - Details/Summary accordions
// - Form accent colors
// - Touch/Overscroll behavior
// - CSS Trigonometry animations
// - CSS Shapes for text wrapping
// - OpenType Font Features
// - Interpolate Size (animate to height: auto)
// - Starting Style entry animations
// - Custom Highlight API
// - CSS @scope scoping
// - @counter-style custom list markers
// - Font Palette color fonts
// - CSS Nesting patterns
//
// ADVANCED FEATURES:
// ------------------
// - Scroll Snap (carousels without JS)
// - Safe Area Insets (notched devices)
// - 3D Transforms & Perspective
// - Clip-path Shapes
// - Blend Modes & Filters
// - Custom Scrollbars
// - Multi-column Layout
// - Line Clamp (text truncation)
// - Writing Modes (vertical text)
// - Performance Utilities (contain, content-visibility)
// - Deep Accessibility (prefers-*, forced-colors)
// - SVG Utilities (fill, stroke)
// - Advanced Container Units (cqw, cqh, cqi, cqb)
// - Smart Anchor Positioning with Fallbacks
// - Advanced Scroll-driven Animations v2
// - OKLCH Color Manipulation System
// - Custom Timeline Controls
// - Progressive Enhancement Patterns
//
// USAGE:
// ------
// @use "kyrolus-sous-materials/styles/styles";
//
// THEMING:
// --------
// <html data-theme="dark">     Dark mode
// <html data-theme="light">    Light mode (default)
// <html data-theme="auto">     Follow system preference
// <html data-theme="high-contrast">  High contrast mode
// <html dir="rtl">             Right-to-left layout
//
// TOTAL UTILITY CLASSES: ~18,000+
// BROWSER SUPPORT: Chrome 115+, Firefox 118+, Safari 16.4+, Edge 115+
// =============================================================================

// =============================================================================
// CSS LAYERS - Control specificity order
// =============================================================================
@layer reset, tokens, theme, base, components, utilities, states, overrides;

// =============================================================================
// LAYER: RESET - Modern CSS reset
// =============================================================================
@layer reset {
  @use "base/modern-reset" as *;
}

// =============================================================================
// LAYER: TOKENS - Design system primitives + additional tokens
// =============================================================================
@layer tokens {
  @use "tokens/primitives" as *;
  @use "tokens/semantic" as *;
  @use "tokens/extended-colors" as *;
  @use "tokens/advanced" as *;
}

// =============================================================================
// LAYER: THEME - Light/Dark mode + RTL support + High Contrast
// =============================================================================
@layer theme {
  @use "abstracts/theme" as *;
  @use "tokens/dark-mode" as *;
}

// =============================================================================
// LAYER: BASE - Default element styles
// =============================================================================
@layer base {
  @use "sass:map";
  @use "tokens/primitives" as primitives;

  // Core HTML setup
  html {
    font-size: 100%;
    scroll-behavior: smooth;
    text-size-adjust: 100%;

    @media (prefers-reduced-motion: reduce) {
      scroll-behavior: auto;
    }
  }

  body {
    font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI",
      Roboto, "Helvetica Neue", Arial, sans-serif;
    font-size: 1rem;
    line-height: 1.5;
    color: var(--text);
    background-color: var(--bg);
    transition: background-color 0.2s ease, color 0.2s ease;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
  }

  // Headings with fluid sizing
  h1 {
    font-size: clamp(2rem, 5vw, 3rem);
    line-height: 1.2;
    font-weight: 700;
  }
  h2 {
    font-size: clamp(1.75rem, 4vw, 2.5rem);
    line-height: 1.25;
    font-weight: 700;
  }
  h3 {
    font-size: clamp(1.5rem, 3vw, 2rem);
    line-height: 1.3;
    font-weight: 600;
  }
  h4 {
    font-size: clamp(1.25rem, 2.5vw, 1.5rem);
    line-height: 1.35;
    font-weight: 600;
  }
  h5 {
    font-size: clamp(1.125rem, 2vw, 1.25rem);
    line-height: 1.4;
    font-weight: 500;
  }
  h6 {
    font-size: 1rem;
    line-height: 1.5;
    font-weight: 500;
  }

  // Links
  a {
    color: var(--primary);
    text-decoration: none;
    transition: color 0.2s ease;

    &:hover {
      color: var(--primary-hover);
      text-decoration: underline;
    }
  }

  // Focus states for accessibility
  :focus-visible {
    outline: 2px solid var(--border-focus);
    outline-offset: 2px;
  }

  // Selection
  ::selection {
    background-color: var(--primary-light);
    color: var(--text);
  }
}

// =============================================================================
// LAYER: COMPONENTS - Angular component styles
// =============================================================================
@layer components {
  @use "components/button" as *;
  @use "components/input" as *;
  @use "components/card" as *;
  @use "components/loaders" as *;
  @use "components/accordion" as *;
  @use "components/table" as *;
  @use "components/paginator" as *;
  @use "components/menu" as *;
}

// =============================================================================
// LAYER: UTILITIES - All utility classes
// =============================================================================
@layer utilities {
  // New powerful utilities
  @use "tokens/color-utilities" as *;
  @use "tokens/typography" as *;
  @use "tokens/spacing" as *;
  @use "tokens/layout" as *;
  @use "tokens/animations" as *;
  @use "tokens/effects" as *;
  @use "tokens/accessibility" as *;

  // State variants and interactions
  @use "tokens/states" as *;
  @use "tokens/group-peer" as *;

  // Angular integration
  @use "tokens/angular" as *;

  // Cutting-edge CSS features (industry first!)
  @use "tokens/cutting-edge" as *;

  // View Transitions API utilities
  @use "tokens/view-transitions" as *;

  // Scroll-driven animations
  @use "tokens/scroll-animations" as *;

  // CSS Anchor Positioning
  @use "tokens/anchor-positioning" as *;

  // Full logical properties for RTL/LTR
  @use "tokens/logical-properties" as *;

  // Container query units (cqi, cqw, cqh)
  @use "tokens/container-units" as *;

  // CSS Layers utilities
  @use "tokens/css-layers" as *;

  // Subgrid utilities
  @use "tokens/subgrid" as *;

  // Popover API styling
  @use "tokens/popover-api" as *;

  // Modern viewport units (dvh, svh, lvh)
  @use "tokens/viewport-units" as *;

  // Motion path animations
  @use "tokens/motion-path" as *;

  // CSS masks and masking
  @use "tokens/masks" as *;

  // @property typed custom properties
  @use "tokens/css-properties" as *;

  // Advanced text decoration
  @use "tokens/text-decoration" as *;

  // OKLCH color system
  @use "tokens/oklch-colors" as *;

  // Native Dialog element styling
  @use "tokens/dialog-element" as *;

  // Details/Summary (native accordions)
  @use "tokens/details-summary" as *;

  // Form accent colors and modern form styling
  @use "tokens/form-accent" as *;

  // Touch behavior and overscroll utilities
  @use "tokens/touch-behavior" as *;

  // CSS Trigonometry animations
  @use "tokens/trigonometry" as *;

  // CSS Shapes (shape-outside for text wrapping)
  @use "tokens/css-shapes" as *;

  // OpenType Font Features
  @use "tokens/font-features" as *;

  // Interpolate Size (animate to height: auto)
  @use "tokens/interpolate-size" as *;

  // Starting Style (CSS-only entry animations)
  @use "tokens/starting-style" as *;

  // Custom Highlight API
  @use "tokens/highlight-api" as *;

  // CSS @scope - Scoped styles
  @use "tokens/css-scope" as *;

  // @counter-style - Custom list markers
  @use "tokens/counter-style" as *;

  // Font Palette - Color fonts
  @use "tokens/font-palette" as *;

  // CSS Nesting patterns
  @use "tokens/css-nesting" as *;

  // Color mixing utilities (color-mix())
  @use "tokens/color-mix" as *;

  // Light-dark function utilities
  @use "tokens/light-dark" as *;

  // Relative color syntax utilities
  @use "tokens/relative-color" as *;

  // Text wrap balance/pretty
  @use "tokens/text-wrap" as *;

  // :has() selector utilities
  @use "tokens/has-selector" as *;

  // Scroll snap utilities
  @use "tokens/scroll-snap" as *;

  // Content visibility (performance)
  @use "tokens/content-visibility" as *;

  // Aspect ratio utilities
  @use "tokens/aspect-ratio" as *;

  // Focus visible utilities
  @use "tokens/focus-visible" as *;

  // Linear easing functions
  @use "tokens/linear-easing" as *;

  // Object view box (image cropping)
  @use "tokens/object-view-box" as *;

  // Wide gamut colors (display-p3)
  @use "tokens/wide-gamut" as *;

  // NEW ADVANCED FEATURES
  // ====================

  // Advanced Math Functions & Modular Scales
  @use "tokens/math-functions" as *;

  // Advanced Grid Features & Subgrid Improvements
  @use "tokens/grid-advanced" as *;

  // CSS Layers Composition Patterns
  @use "tokens/layers-composition" as *;

  // Advanced Accessibility Features
  @use "tokens/accessibility-advanced" as *;

  // Advanced interaction utilities
  @use "tokens/interactions" as *;

  // Visual effects (shapes, blends, 3D, scrollbars, filters)
  @use "tokens/visual-effects" as *;

  // Advanced typography (columns, line-clamp, writing-mode)
  @use "tokens/typography-advanced" as *;

  // Performance optimization utilities
  @use "tokens/performance" as *;

  // Deep accessibility utilities
  @use "tokens/accessibility-deep" as *;

  // SVG utilities
  @use "tokens/svg" as *;

  // Legacy utilities (backward compatibility)
  @use "layout/grid" as *;
  @use "layout/flex" as *;
  @use "layout/alignments" as *;
  @use "utilities/elevations" as *;

  // Angular directive support
  @use "utilities/draggable" as *;
  @use "utilities/resizable" as *;
  @use "utilities/googleicons" as *;
}

// =============================================================================
// LAYER: STATES - State-specific utilities (hover, focus, dark mode variants)
// =============================================================================
@layer states {
  // State variants are loaded in utilities layer
  // This layer provides higher specificity for state-based overrides
}

// =============================================================================
// LAYER: OVERRIDES - For custom overrides (empty by default)
// =============================================================================
@layer overrides {
  // Add custom overrides here or in your app
}

// =============================================================================
// MIXIN INCLUDES - Generate utility classes
// =============================================================================
@use "abstracts/mixins" as mixins;

@include mixins.generate-display-classes;
@include mixins.generate-responsive-display-classes;
@include mixins.generate-width-classes;
@include mixins.generate-height-classes;

// =============================================================================
// GLOBAL UTILITIES (Outside layers for maximum specificity)
// =============================================================================

// Backdrop overlay
.backdrop {
  position: fixed;
  inset: 0;
  visibility: hidden;
  opacity: 0;
  transition: all 0.3s ease-in-out;
  z-index: 1040;
  background-color: transparent;

  &.backdrop-show,
  &[data-show="true"] {
    visibility: visible;
    opacity: 1;
    background-color: var(--overlay);
  }
}

// Fullscreen mode
.fullscreen {
  position: fixed !important;
  inset: 0.5rem !important;
  width: calc(100dvw - 1rem) !important;
  height: calc(100dvh - 1rem) !important;
  overflow: auto !important;
  z-index: 1050;
}

*:fullscreen {
  position: fixed !important;
  inset: 0 !important;
  margin: 0 !important;
  width: 100vw !important;
  height: 100vh !important;
  max-width: none !important;
  max-height: none !important;
  transform: none !important;
  border-radius: 0 !important;
  overflow: auto !important;
}

*::backdrop {
  background: var(--overlay);
}

// Ripple effect
@keyframes ripple-animation {
  to {
    transform: scale(4);
    opacity: 0;
  }
}

.ripple {
  position: relative;
  overflow: hidden;

  &::after {
    content: "";
    position: absolute;
    top: 50%;
    left: 50%;
    width: 0.5rem;
    height: 0.5rem;
    background: rgba(255, 255, 255, 0.3);
    border-radius: 50%;
    transform: translate(-50%, -50%) scale(0);
    opacity: 0;
    pointer-events: none;
  }

  &:active::after {
    animation: ripple-animation 0.6s ease-out;
  }
}

// =============================================================================
// ANGULAR DASHBOARD LAYOUT STYLES
// =============================================================================

.navbar-height {
  height: 56px;
}

.default-transition {
  transition-duration: 225ms;
  transition-timing-function: cubic-bezier(0.4, 0, 0.2, 1);
}

.default-filter-grayscale {
  filter: grayscale(1);
}

.hover-effect:hover {
  filter: grayscale(0.6);
}

// Text stroke utilities
.text-stroke-white {
  text-shadow: 0.8px 0 0 white, 0 0.5px 0 white, -0.5px 0 0 white,
    0 -0.6px 0 white;
}

.text-stroke-black {
  text-shadow: 0.8px 0 0 black, 0 0.5px 0 black, -0.5px 0 0 black,
    0 -0.6px 0 black;
}

.scale-0 {
  transform: scale(0);
}

// Sidenav toggle animations
.sidenav-toggle {
  transition: transform 0.3s ease;

  &[opened="false"] {
    transform: translateX(-100%);
  }

  &[opened="true"] {
    transform: translateX(0);
  }
}

// RTL support for sidenav
[dir="rtl"] .sidenav-toggle[opened="false"] {
  transform: translateX(100%);
}

// Dashboard layout padding
ks-dashboard-layout[ng-reflect-sidebar-mode="side"] {
  .sidenav-toggle[opened="false"] + div {
    padding-inline-start: 0;
  }

  .sidenav-toggle[opened="true"] + div {
    padding-inline-start: var(--sidebar-width, 250px);
  }
}

// =============================================================================
// PRINT STYLES
// =============================================================================
@media print {
  .no-print,
  .no-print * {
    display: none !important;
  }

  .print-only {
    display: block !important;
  }

  body {
    background: white !important;
    color: black !important;
  }
}

// =============================================================================
// RTL HELPERS
// =============================================================================

// Flip icons/elements in RTL
.flip-rtl {
  [dir="rtl"] & {
    transform: scaleX(-1);
  }
}

// Force LTR for specific content (like phone numbers, code)
.ltr-only {
  direction: ltr;
  unicode-bidi: isolate;
}

// Force RTL for specific content
.rtl-only {
  direction: rtl;
  unicode-bidi: isolate;
}

// =============================================================================
// DARK MODE HELPERS
// =============================================================================

// Show only in dark mode (works with both data-theme and class)
.dark-only {
  display: none !important;

  [data-theme="dark"] &,
  .dark & {
    display: initial !important;
  }
}

// Show only in light mode (works with both data-theme and class)
.light-only {
  [data-theme="dark"] &,
  .dark & {
    display: none !important;
  }
}

// Invert colors for images in dark mode
.invert-dark {
  [data-theme="dark"] &,
  .dark & {
    filter: invert(1) hue-rotate(180deg);
  }
}
